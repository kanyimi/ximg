{% load i18n %}
<div class="dash-card">
  <div class="dash-card-head">

    <form id="filesSearchForm" class="dash-search">
      <input type="text" name="q" value="{{ q }}" placeholder="Search by file name or section slug...">
      <button class="dash-btn" type="submit">{% translate "Search" %}</button>
    </form>
  </div>
  <div class="dash-table-wrap">
    <table class="dash-table">
      <thead>
        <tr>
          <th>{% translate "Original name" %}</th>
          <th>{% translate "Section" %}</th>
          <th>{% translate "Uploaded" %}</th>
          <th>{% translate "Download" %}</th>
        </tr>
      </thead>
      <tbody>
        {% for f in files %}
          <tr>
            <td title="{{ f.original_name }}">{{ f.original_name }}</td>
            <td><code>{{ f.section.slug }}</code></td>
            <td>{{ f.uploaded_at|date:"d.m.Y" }}</td>
            <td>
              {% with name=f.original_name|lower %}
                {% if name|slice:"-4:" == ".png" or name|slice:"-4:" == ".jpg" or name|slice:"-5:" == ".jpeg" or name|slice:"-4:" == ".gif" or name|slice:"-5:" == ".webp" %}
              <a class="dash-link-small js-img-preview"
                 href="{% url 'dashboard:preview_file' slug=f.section.slug file_id=f.id %}"
                 data-filename="{{ f.original_name|escape }}">
                <i class="fa fa-eye" style="font-size:24px"></i>
              </a>
                {% else %}
                  <a class="dash-link-small"
                     href="{% url 'photohostapp:download_file' slug=f.section.slug file_id=f.id %}"
                     target="_blank" style="color:#227851;">
                    <i class="fa fa-download" style="font-size:24px"></i>
                  </a>
                {% endif %}
              {% endwith %}
            </td>


          </tr>
        {% empty %}
          <tr><td colspan="4" class="dash-muted">{% translate "No files found." %}</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  {% if page_obj.paginator.num_pages > 1 %}
  <div class="dash-pager">
    <div class="dash-pager-left">
      {% if page_obj.has_previous %}
        <a class="dash-pager-btn" href="?q={{ q|urlencode }}&page=1"><i class="fa fa-angle-double-left" style="font-size:24px;color:#227851;"></i></a>
        <a class="dash-pager-btn" href="?q={{ q|urlencode }}&page={{ page_obj.previous_page_number }}"><i class="fa fa-angle-left" style="font-size:24px;color:#227851;"></i></a>
      {% else %}
        <span class="dash-pager-btn is-disabled"><i class="fa fa-angle-double-left" style="font-size:24px;color:#227851;"></i></span>
        <span class="dash-pager-btn is-disabled"><i class="fa fa-angle-left" style="font-size:24px;color:#227851;"></i></span>
      {% endif %}
    </div>

    <div class="dash-pager-mid">
      Page <strong>{{ page_obj.number }}</strong> of <strong>{{ page_obj.paginator.num_pages }}</strong>
      <span class="dash-muted">({{ page_obj.paginator.count }} files)</span>
    </div>

    <div class="dash-pager-right">
      {% if page_obj.has_next %}
        <a class="dash-pager-btn" href="?q={{ q|urlencode }}&page={{ page_obj.next_page_number }}"><i class="fa fa-angle-right" style="font-size:24px;color:#227851;"></i></a>
        <a class="dash-pager-btn" href="?q={{ q|urlencode }}&page={{ page_obj.paginator.num_pages }}"><i class="fa fa-angle-double-right" style="font-size:24px;color:#227851;"></i></a>
      {% else %}
        <span class="dash-pager-btn is-disabled"><i class="fa fa-angle-right" style="font-size:24px;color:#227851;"></i></span>
        <span class="dash-pager-btn is-disabled"><i class="fa fa-angle-double-right" style="font-size:24px;color:#227851;"></i></span>
      {% endif %}
    </div>
  </div>
{% endif %}

</div>



<!-- Image Preview Modal -->
<div id="imgPreviewModal" class="dash-img-modal" aria-hidden="true">
  <div class="dash-img-modal__overlay" data-close="1"></div>

  <div class="dash-img-modal__dialog" role="dialog" aria-modal="true" aria-labelledby="imgPreviewTitle">
    <div class="dash-img-modal__head">
      <div id="imgPreviewTitle" class="dash-img-modal__title">Preview</div>

      <button type="button" class="dash-img-modal__close" id="imgPreviewClose" aria-label="Close">
        <i class="fa fa-times"></i>
      </button>
    </div>

    <div class="dash-img-modal__body">
      <img id="imgPreviewImg" alt="" />
    </div>
  </div>
</div>



